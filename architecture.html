<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <title>Touring</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">    
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
      <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
          <a class="navbar-brand d-flex flex-column align-items-center text-decoration-none" href="home.html">
            <img class="logo" src="images/touringlogo.png" alt="Touring Logo">
            <span class="brand-text">Touring</span>
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
            <ul class="navbar-nav d-flex align-items-center justify-content-center w-100">
              <li class="nav-item">
                <div class="logo-container">
                  <a class="nav-link login-link" href="history.html">
                    <img class="logo" src="images/history.png" alt="Login Icon">
                    <span class="login-text">History</span>
                  </a>
                </div>
              </li>
              <li class="nav-item">
                <div class="logo-container">
                  <a class="nav-link login-link" href="architecture.html">
                    <img class="logo" src="images/architecture.png" alt="Login Icon">
                    <span class="login-text">Architecture</span>
                  </a>
                </div>
              </li>
              <li class="nav-item">
                <div class="logo-container">
                  <a class="nav-link login-link" href="treasures.html">
                    <img class="logo" src="images/treasures.png" alt="Login Icon">
                    <span class="login-text">Treasures</span>
                  </a>
                </div>
              </li>

              <li class="nav-item">
                <div class="logo-container">
                  <a class="nav-link login-link" href="paths.html">
                    <img class="logo" src="images/paths.png" alt="Login Icon">
                    <span class="login-text">Paths</span>
                  </a>
                </div>
              </li>
              <li class="nav-item">
                <div class="logo-container">
                  <a class="nav-link login-link" href="Quiz.html">
                    <img class="logo" src="images/quiz.png" alt="Login Icon">
                    <span class="login-text">Quiz</span>
                  </a>
                </div>
              </li>
              <li class="nav-item ms-auto">
                <div class="logo-container">
                  <a class="nav-link login-link" href="profile.html">
                    <img class="logo" src="images/touristboy.png" alt="Login Icon">
                    <span class="login-text">Profile</span>
                  </a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <br>
      <img class="logo" src="images/architecture.png" alt="Login Icon">
      <h2 style="color: gray;"> <b>Architecture</b></h2>
      <div class="container my-5">
        <div class="row justify-content-center">
          <div class="col-md-12 p-4 bg-light rounded shadow mx-auto">
            <form>
              <div class="mb-3">
                <h5 style="color: gray;"> Is the architecture of Andros any different than the rest of the Cycladic islands?</h5>
                <p>Andros is a very interesting island in Greece probably because it is not a typical example of <b>Cycladic architecture</b> but rather a mixture of different characteristics. Typical Aegean type houses that coexist with neoclassical buildings, Venetian towers, and fortresses, towers like the <b>Hellenistic Tower of Agios Petros</b>, old <b>watermills</b> and fountains create this beautiful setting of unique harmony.</p>
                <h5 style="color: gray;"> <b>Architecture of Andros</b></h5>
                <p>The architecture of Andros has many aspects but it is especially known for the cosmopolitan atmosphere and the cultural identity that preserves the last decades. Around the <b>Chora</b> of Andros and the picturesque villages, one can see perfect examples of rural houses standing close to Venetian towers.
                Equally impressive are the beautiful mansions that can be found around the island which were built during the Turkish rule painted with different colors. Another characteristic of Andros island is the many dovecotes that adorn the island and can be found mostly in <b>Korthi</b> region. Stone structures built in geometric shapes forming triangles, diamonds and circles give the island a beautiful tone.</p>
                
                <div id="imageCarousel3" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner">
                    <div class="carousel-item active">
                      <img src="images/church.jpg" class="d-block w-100" alt="..." style="height: 600px; object-fit: cover;">
                      <h5 id="caption" class="card-title caption-bold" style="color: gray;">Agia Thalassini</h5>

                    </div>
                    <div class="carousel-item">
                      <img src="images/town.jpg" class="d-block w-100" alt="..." style="height: 600px; object-fit: cover;">
                      <h5 id="caption" class="card-title caption-bold" style="color: gray;">Chora - Andros</h5>
                    </div>
                    <div class="carousel-item">
                      <img src="images/house.jpg" class="d-block w-100" alt="..." style="height: 600px; object-fit: cover;">
                      <h5 id="caption" class="card-title caption-bold" style="color: gray;">Chora - Andros</h5>
                    </div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel3" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel3" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
                <br><br>
                <h5 style="color: gray;"> <b>Stone structures</b></h5>
                <p>In the region of <b>Korthi</b>, traditional stone-built houses dominate the architectural landscape, offering a glimpse into the island’s rural past. These homes, often modest in size, are constructed with local stone and feature thick walls, small wooden windows, and tile roofs, designed to withstand the strong winds of the Aegean. Their earthy tones blend naturally with the surrounding terrain, creating a harmonious connection between architecture and nature. Many of these structures have been carefully preserved or restored, maintaining their authenticity while serving as a testament to the craftsmanship and self-sufficiency of past generations.</p>
                <img class="img-fluid" src="images/stone.jpg" alt="Touring Logo">
                <h5 id="caption" class="card-title caption-bold" style="color: gray;">Korthi Stone structures</h5>
                
                <div class="container my-5">
                  <h4 class="text-center mb-3" style="color: gray;">Here is a challenge for you<br><b>Drag and Drop the pieces to create the tower!</b></h4>
                  <div class="row justify-content-center align-items-start">
                    <div class="col-md-7">
                      <canvas id="puzzleCanvas" class="border rounded shadow w-100"></canvas>
                      <div class="text-center mt-3">
                        <button id="resetBtn" class="btn btn-secondary px-4">Start Again</button>
                      </div>
                    </div>
                    <div class="col-md-4 text-center">
                      <h6 class="mb-2" style="color: gray;">Finished Image:</h6>
                      <img src="images/pyrgos.jpg" class="img-fluid rounded shadow" style="max-height: 250px;">
                    </div>
                  </div>
                </div>

                <h5 style="color: gray;"> <b><u>Overview of the island</u></b></h5>
                <p>With it's unique architecture, <b>Andros</b>, is truly a remarkable island that attracts tourists from all around the world. <br>Still don't believe us? Watch the video below to get the full expirence:</p>
                
                <div class="card mb-4 shadow-sm border-1 rounded">
                  <div class="ratio ratio-16x9" style="max-width: 100%; height: 600px;">
                    <iframe 
                      src="https://www.youtube.com/embed/_yAmM-Ysl1U" 
                      title="YouTube video"
                      allowfullscreen>
                    </iframe>
                  </div>
                </div>
                
                 <!--Εμφανίζεται μετά το σκόρ στο quiz να είναι πάνω απο 10-->
                <div id="architectureBonus" style="display: none;">
                <h5 style="color: gray;"> <b>*New Information*</b></h5>
                <div id="imageCarousel1" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner">
                    <div class="carousel-item active">
                      <img src="images/me1.png" class="d-block w-100" alt="..." style="height: 500px; object-fit: cover;">
                    </div>
                    <div class="carousel-item">
                      <img src="images/a2.jpg" class="d-block w-100" alt="..." style="height: 500px; object-fit: cover;">
                    </div>
                    <div class="carousel-item">
                      <img src="images/me2.png" class="d-block w-100" alt="..." style="height: 500px; object-fit: cover;">
                    </div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel1" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel1" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
                <h5 style="color: gray;"> <b>The Cyclades Olive Museum</b></h5>
                <p>The Cyclades Olive Museum is a private museum located in the mountainous village of Ano Pitrofos, very close to Menites. This museum is housed in a traditional building that was bought and restored by civil engineer Dimitris Chelmis, originating from Pitrofos and personal guide to the museum. The old oil mill that houses the museum is part of a two-floor building and occupies a large part of the ground floor (called katogi). The upper floor used to host the home of the owner. This fine example of animal-powered olive oil producing mill was very frequently met in the countryside of Andros island, operating until the 1960s.<br><br>The building of the Cyclades Olive Museum dates from earlier than 1857 and was probably operating during the 18th century. Its architectural elements, like arches and domes, are common in rural architecture of Andros and generally in the Cyclades islands. Until 1967 the oil mill stopped operating and until 1997 it was used as a storehouse. That year, the entire building (oil mill and house) was bought by its present owner, Dimitris Chelmis, and it was later restored and transformed into a museum. Visitors can get a view of the traditional oil production method in Andros and learn a lot about the local culture.</p>

                </div>

                <div class="container my-4">
                  <div class="d-flex justify-content-end">
                    <div class="p-3 border rounded bg-white text-end" style="max-width: 300px;">
                      <button style="color: white; position: relative; z-index: 10;" type="button" class="btn btn-info mt-2" onclick="location.href='Quiz.html?id=Architecture'"><b>Test</b></button>
                      <img src="images/quiz.png" alt="Quiz icon" style="width: 50px;">
                      <p class="text-muted fst-italic mb-0" style="font-size: 0.9rem;">
                        Let's see what you've learned about the Architecture of Andros!
                      </p>
                    </div>
                  </div>
                </div>

                </div>
            </form>
          </div>
        </div>
      </div>


      
      <script>
        
      /*Puzzle*/
      const rows = 3, cols = 3;
      const canvas = document.getElementById('puzzleCanvas');
      const ctx = canvas.getContext('2d');
      const img = new Image();
      img.src = 'images/pyrgos.jpg';

      let pieces = [], pieceW, pieceH, selected = null;

      img.onload = () => {
        canvas.width = 600;
        canvas.height = 600;
        pieceW = canvas.width / cols;
        pieceH = canvas.height / rows;

        for (let y = 0; y < rows; y++) {
          for (let x = 0; x < cols; x++) {
            pieces.push({
              sx: x * (img.width / cols),
              sy: y * (img.height / rows),
              x: Math.random() * (canvas.width - pieceW),
              y: Math.random() * (canvas.height - pieceH),
              correctX: x * pieceW,
              correctY: y * pieceH
            });
          }
        }
        draw();
      };

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (const p of pieces) {
          ctx.drawImage(img, p.sx, p.sy, img.width / cols, img.height / rows, p.x, p.y, pieceW, pieceH);
          ctx.strokeRect(p.x, p.y, pieceW, pieceH);
        }
      }

      function checkSolved() {
        return pieces.every(p =>
          Math.abs(p.x - p.correctX) < 5 && Math.abs(p.y - p.correctY) < 5
        );
      }

      function launchConfetti() {
        const duration = 2 * 1000;
        const animationEnd = Date.now() + duration;
        const defaults = { startVelocity: 25, spread: 360, ticks: 60, zIndex: 999 };

        const interval = setInterval(() => {
          const timeLeft = animationEnd - Date.now();

          if (timeLeft <= 0) return clearInterval(interval);

          confetti(Object.assign({}, defaults, { origin: { x: 0.1, y: 0.5 } }));
          confetti(Object.assign({}, defaults, { origin: { x: 0.9, y: 0.5 } }));
        }, 200);
      }

      canvas.addEventListener('mousedown', e => {
        const { offsetX, offsetY } = e;
        for (const p of pieces) {
          if (offsetX >= p.x && offsetX <= p.x + pieceW &&
              offsetY >= p.y && offsetY <= p.y + pieceH) {
            selected = p;
            selected.offsetX = offsetX - p.x;
            selected.offsetY = offsetY - p.y;
            break;
          }
        }
      });

      canvas.addEventListener('mousemove', e => {
        if (selected) {
          selected.x = e.offsetX - selected.offsetX;
          selected.y = e.offsetY - selected.offsetY;
          draw();
        }
      });

      canvas.addEventListener('mouseup', () => {
        if (selected) {
          if (Math.abs(selected.x - selected.correctX) < 15 &&
              Math.abs(selected.y - selected.correctY) < 15) {
            selected.x = selected.correctX;
            selected.y = selected.correctY;
          }
          selected = null;
          draw();
          if (checkSolved()) launchConfetti();
        }
      });
          document.getElementById('resetBtn').addEventListener('click', () => {
          for (const p of pieces) {
            p.x = Math.random() * (canvas.width - pieceW);
            p.y = Math.random() * (canvas.height - pieceH);
          }
            draw();
          });

        //new information
        window.addEventListener('DOMContentLoaded', () => {
  let user = JSON.parse(localStorage.getItem('user'));
  const bonus = document.getElementById('historyBonus');

  // ✅ 1. Trigger από προηγούμενη σελίδα
  if (user?.triggerReload) {
    console.log("🔁 Εκτελείται forced reload από Quiz...");
    delete user.triggerReload;
    localStorage.setItem("user", JSON.stringify(user));
    location.reload(); // Θα ξανατρέξει όλο το DOMContentLoaded
    return;
  }

  // ✅ 2. Προστασία – αν δεν υπάρχει χρήστης
  if (!user || !user.email || !bonus) {
    console.warn("⚠️ Δεν υπάρχει χρήστης ή bonus block.");
    return;
  }

  // ✅ 3. Έλεγχος flag ή τοπικού σκορ
  const unlocked = user.historyUnlocked === true;
  const scoreOkay = user.score_history && user.score_history >= 10;

  if (unlocked || scoreOkay) {
    console.log("🎉 Εμφανίζεται το History Bonus (από localStorage)");
    bonus.style.display = 'block';
  } else {
    console.log("🔒 Δεν έχει ξεκλειδωθεί ακόμα το History bonus.");
  }

  // ✅ 4. Προαιρετική επιβεβαίωση από API
  fetch(`/api/get-score?email=${user.email}&category=history`)
    .then(res => {
      if (!res.ok) throw new Error("Σφάλμα ανάκτησης score.");
      return res.json();
    })
    .then(data => {
      const score = data.score;
      user.score_history = score;
      localStorage.setItem('user', JSON.stringify(user));

      if (score >= 10) {
        console.log("✅ API λέει: Score >= 10 -> εμφάνιση bonus");
        bonus.style.display = 'block';
      }
    })
    .catch(err => console.error("❌ Σφάλμα score:", err));
});
const user = JSON.parse(localStorage.getItem('user'));
const bonus = document.getElementById('historyBonus');

if (user?.historyUnlocked === true && bonus) {
  bonus.style.display = 'block';
} else {
  console.log("🔒 Δεν έχει ξεκλειδωθεί το bonus.");
}
      </script>
      <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>